<table mat-table [dataSource]="histories" id="data-table" class="mat-elevation-z8">

    <!-- Sender Column -->
    <ng-container matColumnDef="sender">
      <th mat-header-cell class="header" *matHeaderCellDef> Sender </th>
      <td mat-cell *matCellDef="let history" class="reactiveDataColumn">
        <div class="senderContainer">
          <div class="senderInfoDiv">
            <button mat-raised-button class="reactive senderAssignmentButton" *ngIf="!onProfile && history.assignmentRecieverClient.clientID != null && history.assignmentSenderClient.clientID != null"
              (click)="emitSelectedRecipientInformation(history.assignmentSenderClient, history.eventType)">{{ history.assignmentSenderClient.clientNickname }}</button>
              <button mat-raised-button class="reactive senderAssignmentButton" *ngIf="!onProfile && history.relationXrefID == null"
              (click)="emitSelectedRecipientInformation(history.conversationClient, null)">{{ history.conversationClient.clientNickname }}</button>
            <span *ngIf="onProfile">{{history.assignmentSenderClient.clientNickname}}</span>
          </div>
          <img class="senderImage" [ngClass]="{'cardExchangeIcon' : history.eventType.eventDescription == 'Card Exchange','giftExchangeIcon' : history.eventType.eventDescription == 'Gift Exchange'}">
        </div>
      </td>
    </ng-container>

    <!-- Assignment Column -->
    <ng-container matColumnDef="assignment">
      <th mat-header-cell class="header" *matHeaderCellDef> Assignment </th>
      <td mat-cell *matCellDef="let history" class="reactiveDataColumn">
        <span class="reactive" *ngIf="history.assignmentRecieverClient.clientNickname == undefined || history.assignmentRecieverClient.clientNickname == ''">------------</span>
        <button class="reactive senderAssignmentButton" *ngIf="history.assignmentRecieverClient.clientNickname != undefined && history.assignmentRecieverClient.clientNickname != ''"
          (click)="emitSelectedRecipientInformation(history.assignmentRecieverClient, history.eventType)" mat-raised-button>{{ history.assignmentRecieverClient.clientNickname }}</button>
      </td>
    </ng-container>

    <!-- Event Column -->
    <ng-container matColumnDef="event">
      <th mat-header-cell class="header" *matHeaderCellDef> Event </th>
      <td mat-cell *matCellDef="let history" class="reactiveDataColumn">
        <span class="chatDescription" *ngIf="history.eventType.eventDescription != null">{{history.eventType.eventDescription}}</span>
        <span class="chatDescription" *ngIf="history.eventType.eventDescription == null">General</span>
      </td>
    </ng-container>

    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <th mat-header-cell class="header" *matHeaderCellDef> Status </th>
      <td mat-cell *matCellDef="let history" class="reactiveDataColumn" [ngClass]="{'completedTd' : isCompleted(history)}">
        <span class="reactive" *ngIf="history.relationXrefID && !isCompleted(history)">{{ history.assignmentStatus.assignmentStatusName }}</span>
        <span class="reactive" *ngIf="!history.relationXrefID">------------</span>
      </td>
    </ng-container>

    <!-- Contact Column -->
    <ng-container matColumnDef="contact">
      <th mat-header-cell class="header" *matHeaderCellDef> Correspondence History </th>
      <td mat-cell *matCellDef="let history" class="reactiveDataColumn">
        <!-- Disabled if disabled overall, is an admin and on profile, if the viewerClient is the same as the conversation client (implying it is the same person), or the conversation client does not have an account-->
        <button mat-raised-button class="historyButton" *ngIf="history.conversationClient.hasAccount"
          (click)="emitSelectedHistory(history);"
          [disabled]="disabled || (isAdmin && onProfile) || viewerClient.clientID == history.conversationClient.clientID"
          [matBadge]="history.unreadCount"
          [matBadgeHidden]="history.unreadCount == 0">Correspondence</button>
        <button mat-raised-button class="historyButton" *ngIf="!history.conversationClient.hasAccount" [disabled]="true">No Account</button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columns"></tr>
    <tr mat-row *matRowDef="let row; columns: columns;"></tr>
</table>
